---
phase: 05-publishing
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/starter-template/package.json
  - packages/starter-template/vite.config.ts
  - packages/starter-template/react-router.config.ts
  - packages/starter-template/tsconfig.json
  - packages/starter-template/tailwind.config.ts
  - packages/starter-template/app/root.tsx
  - packages/starter-template/app/routes/home.tsx
  - packages/starter-template/app/routes/$.tsx
  - packages/starter-template/app/components/sections/Hero.tsx
  - packages/starter-template/app/components/sections/Features.tsx
  - packages/starter-template/app/components/sections/Footer.tsx
  - packages/starter-template/app/loaders/products.ts
  - packages/starter-template/.deco/pages/page_home.json
  - packages/starter-template/.deco/blocks/sections--Hero.json
  - packages/starter-template/.deco/blocks/sections--Features.json
  - packages/starter-template/.deco/blocks/sections--Footer.json
  - packages/starter-template/.deco/loaders/loaders--products.json
  - packages/starter-template/public/favicon.ico
  - packages/starter-template/README.md
autonomous: true

must_haves:
  truths:
    - "User can scaffold a new project from the template with a working development server"
    - "The template includes example sections with TypeScript props that the CMS scanner can discover"
    - "The template includes a .deco/ directory with pre-configured pages, blocks, and loaders"
    - "The template uses React 19 + Vite + Tailwind CSS 4 + shadcn components"
    - "CMS pages prerender at build time using React Router 7 prerender config"
  artifacts:
    - path: "packages/starter-template/package.json"
      provides: "Template package with React 19, Vite, Tailwind, React Router 7 dependencies"
      contains: "react-router"
    - path: "packages/starter-template/react-router.config.ts"
      provides: "Prerender configuration reading .deco/pages/ for dynamic routes"
      contains: "prerender"
    - path: "packages/starter-template/app/components/sections/Hero.tsx"
      provides: "Example Hero section with typed props"
      contains: "export default"
    - path: "packages/starter-template/.deco/pages/page_home.json"
      provides: "Pre-configured home page with block instances"
      contains: "blocks"
    - path: "packages/starter-template/.deco/loaders/loaders--products.json"
      provides: "Example loader definition"
      contains: "inputSchema"
  key_links:
    - from: "packages/starter-template/react-router.config.ts"
      to: "packages/starter-template/.deco/pages/"
      via: "readdir to discover CMS routes for prerender"
      pattern: "readdir.*\\.deco/pages"
    - from: "packages/starter-template/.deco/pages/page_home.json"
      to: "packages/starter-template/.deco/blocks/"
      via: "blockType references in page blocks array"
      pattern: "sections--Hero|sections--Features"
    - from: "packages/starter-template/app/routes/$.tsx"
      to: "packages/starter-template/.deco/pages/"
      via: "Dynamic route reads page config and renders sections"
      pattern: "\\.deco/pages"
---

<objective>
Create a default starter template with React 19, Vite, Tailwind, shadcn, example sections, loaders, and .deco/ scaffolding.

Purpose: Give new users a working starting point that demonstrates all CMS capabilities -- sections with typed props, loaders, and CMS-managed pages. Fulfills PUB-03.

Output: A complete starter template package that can be scaffolded via `deco create`, including working example sections, a pre-configured home page, an example loader, and React Router 7 prerender support.
</objective>

<execution_context>
@/Users/guilherme/.claude/get-shit-done/workflows/execute-plan.md
@/Users/guilherme/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-publishing/05-RESEARCH.md
@.planning/research/STACK.md

# Reference: existing deco create command
@packages/cli/src/commands/create/create.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create starter template package with build toolchain and example sections</name>
  <files>
    packages/starter-template/package.json
    packages/starter-template/vite.config.ts
    packages/starter-template/react-router.config.ts
    packages/starter-template/tsconfig.json
    packages/starter-template/tailwind.config.ts
    packages/starter-template/app/root.tsx
    packages/starter-template/app/routes/home.tsx
    packages/starter-template/app/routes/$.tsx
    packages/starter-template/app/components/sections/Hero.tsx
    packages/starter-template/app/components/sections/Features.tsx
    packages/starter-template/app/components/sections/Footer.tsx
    packages/starter-template/app/loaders/products.ts
    packages/starter-template/public/favicon.ico
  </files>
  <action>
    **Create package.json:**
    ```json
    {
      "name": "@decocms/starter-template",
      "private": true,
      "version": "0.1.0",
      "type": "module",
      "scripts": {
        "dev": "react-router dev",
        "build": "react-router build",
        "preview": "vite preview"
      },
      "dependencies": {
        "react": "^19.2.0",
        "react-dom": "^19.2.0",
        "react-router": "^7.x",
        "@react-router/dev": "^7.x",
        "@react-router/node": "^7.x"
      },
      "devDependencies": {
        "@types/react": "^19.x",
        "@types/react-dom": "^19.x",
        "typescript": "^5.x",
        "vite": "^7.2.1",
        "tailwindcss": "^4.1.x",
        "@tailwindcss/vite": "^4.1.x"
      }
    }
    ```
    Use actual latest stable versions from the research (React 19, Vite 7, Tailwind 4, React Router 7).

    **Create vite.config.ts:**
    ```ts
    import { reactRouter } from "@react-router/dev/vite";
    import tailwindcss from "@tailwindcss/vite";
    import { defineConfig } from "vite";

    export default defineConfig({
      plugins: [tailwindcss(), reactRouter()],
    });
    ```

    **Create react-router.config.ts:**
    Implement the prerender pattern from research. The `prerender` function reads `.deco/pages/` at build time to discover CMS-managed routes:
    ```ts
    import type { Config } from "@react-router/dev/config";
    import { readdir, readFile } from "fs/promises";
    import { join } from "path";

    export default {
      ssr: false,
      async prerender() {
        const pagesDir = join(process.cwd(), ".deco/pages");
        const staticPaths = ["/"];

        try {
          const files = await readdir(pagesDir);
          const cmsPages = await Promise.all(
            files
              .filter((f) => f.endsWith(".json"))
              .map(async (f) => {
                const content = await readFile(join(pagesDir, f), "utf-8");
                const page = JSON.parse(content);
                if (page.deleted) return null;
                return page.path;
              })
          );
          return [...staticPaths, ...cmsPages.filter(Boolean)];
        } catch {
          return staticPaths;
        }
      },
    } satisfies Config;
    ```

    **Create tsconfig.json:**
    Standard React + Vite TypeScript config with `"jsx": "react-jsx"`, `"moduleResolution": "bundler"`, strict mode.

    **Create tailwind.config.ts:**
    Minimal Tailwind 4 config. With Tailwind 4 + @tailwindcss/vite, most config is automatic. Add content paths for `./app/**/*.{ts,tsx}`.

    **Create app/root.tsx:**
    Minimal React Router 7 root layout:
    - HTML document structure with `<head>`, `<body>`
    - Tailwind CSS import (`import "./app.css"` or inline `@import "tailwindcss"`)
    - `<Outlet />` for child routes
    - Basic meta tags (title, viewport)

    **Create app/routes/home.tsx:**
    The home page route (index route for `/`). This demonstrates the CMS rendering pattern:
    - Read `.deco/pages/page_home.json` at build time (for prerender) or use it as default data
    - Map over `blocks` array, resolve each `blockType` to a React component
    - Render sections in order with their props
    - Use a simple `sectionRegistry` object mapping blockType to lazy-loaded component:
      ```ts
      const sectionRegistry: Record<string, React.ComponentType<any>> = {
        "sections--Hero": Hero,
        "sections--Features": Features,
        "sections--Footer": Footer,
      };
      ```

    **Create app/routes/$.tsx:**
    Catch-all route for CMS-managed dynamic pages. Same pattern as home.tsx but reads the page config matching the URL path from `.deco/pages/`.

    **Create 3 example sections in app/components/sections/:**

    **Hero.tsx:**
    ```tsx
    export interface HeroProps {
      /** Main headline text */
      title: string;
      /** Supporting description */
      subtitle: string;
      /** Call-to-action button text */
      ctaText: string;
      /** CTA button link URL */
      ctaUrl: string;
      /** Optional background image URL */
      backgroundImage?: string;
    }

    export default function Hero({ title, subtitle, ctaText, ctaUrl, backgroundImage }: HeroProps) {
      // Full-width hero section with gradient overlay, large title, subtitle, CTA button
      // Use Tailwind: py-24 px-6 text-center bg-gradient-to-br from-blue-600 to-purple-700 text-white
    }
    ```

    **Features.tsx:**
    ```tsx
    export interface Feature {
      /** Feature title */
      title: string;
      /** Feature description */
      description: string;
      /** Icon name (optional) */
      icon?: string;
    }

    export interface FeaturesProps {
      /** Section heading */
      heading: string;
      /** List of features to display */
      features: Feature[];
      /** Number of columns (2, 3, or 4) */
      columns?: 2 | 3 | 4;
    }

    export default function Features({ heading, features, columns = 3 }: FeaturesProps) {
      // Grid of feature cards with icon, title, description
      // Use Tailwind: grid grid-cols-1 md:grid-cols-{columns} gap-8
    }
    ```

    **Footer.tsx:**
    ```tsx
    export interface FooterLink {
      label: string;
      url: string;
    }

    export interface FooterProps {
      /** Company or site name */
      siteName: string;
      /** Copyright year */
      year?: number;
      /** Navigation links */
      links: FooterLink[];
    }

    export default function Footer({ siteName, year, links }: FooterProps) {
      // Simple footer with site name, links, copyright
      // Use Tailwind: bg-gray-900 text-gray-300 py-12 px-6
    }
    ```

    Each section:
    - Has a named `export interface XxxProps` for the CMS scanner to discover
    - Uses `export default function` for the component
    - Has JSDoc comments on props (scanner extracts descriptions)
    - Uses only Tailwind for styling (no external component library required)
    - Is fully functional and visually presentable

    **Create app/loaders/products.ts:**
    ```ts
    export interface ProductsInput {
      /** Maximum number of products to return */
      limit?: number;
      /** Category filter */
      category?: string;
    }

    export interface Product {
      id: string;
      name: string;
      price: number;
      image: string;
    }

    /** Fetches product data from an API */
    export default async function products(input: ProductsInput): Promise<Product[]> {
      // Return mock data for the starter template
      return [
        { id: "1", name: "Classic T-Shirt", price: 29.99, image: "/images/tshirt.jpg" },
        { id: "2", name: "Denim Jacket", price: 89.99, image: "/images/jacket.jpg" },
        { id: "3", name: "Canvas Sneakers", price: 59.99, image: "/images/sneakers.jpg" },
      ].slice(0, input.limit ?? 10);
    }
    ```

    **Create public/favicon.ico:**
    Create a minimal placeholder favicon (can be an empty file or a simple 1x1 pixel ICO).
  </action>
  <verify>All files created in packages/starter-template/. package.json has correct dependencies. react-router.config.ts reads .deco/pages/ for prerender. Three example sections have typed prop interfaces. Loader has typed input/output.</verify>
  <done>Starter template package with React 19, Vite 7, Tailwind 4, React Router 7 created. Three example sections (Hero, Features, Footer) with typed props. One example loader (products) with typed input/output. Prerender config reads CMS pages. Routes render sections from page config.</done>
</task>

<task type="auto">
  <name>Task 2: Add .deco/ scaffolding with pre-configured pages, blocks, and loaders</name>
  <files>
    packages/starter-template/.deco/pages/page_home.json
    packages/starter-template/.deco/blocks/sections--Hero.json
    packages/starter-template/.deco/blocks/sections--Features.json
    packages/starter-template/.deco/blocks/sections--Footer.json
    packages/starter-template/.deco/loaders/loaders--products.json
    packages/starter-template/README.md
  </files>
  <action>
    **Create .deco/pages/page_home.json:**
    A pre-configured home page with 3 block instances matching the example sections:
    ```json
    {
      "id": "page_home",
      "path": "/",
      "title": "Home",
      "blocks": [
        {
          "id": "block_hero1",
          "blockType": "sections--Hero",
          "props": {
            "title": "Build Beautiful Sites with deco.cx",
            "subtitle": "A stack-agnostic CMS that works with your existing TypeScript codebase",
            "ctaText": "Get Started",
            "ctaUrl": "/docs"
          }
        },
        {
          "id": "block_feat1",
          "blockType": "sections--Features",
          "props": {
            "heading": "Why deco.cx?",
            "features": [
              {
                "title": "Visual Editing",
                "description": "Edit your site visually with a live preview. Changes update in real-time.",
                "icon": "edit"
              },
              {
                "title": "TypeScript Native",
                "description": "Your components define the CMS schema. No config files, no boilerplate.",
                "icon": "code"
              },
              {
                "title": "Git-Backed Content",
                "description": "All content lives in git. Branch, review, and deploy with confidence.",
                "icon": "git-branch"
              }
            ],
            "columns": 3
          }
        },
        {
          "id": "block_foot1",
          "blockType": "sections--Footer",
          "props": {
            "siteName": "My Site",
            "year": 2026,
            "links": [
              { "label": "Home", "url": "/" },
              { "label": "About", "url": "/about" },
              { "label": "GitHub", "url": "https://github.com/deco-cx" }
            ]
          }
        }
      ],
      "metadata": {
        "description": "Default home page",
        "createdAt": "2026-01-01T00:00:00.000Z",
        "updatedAt": "2026-01-01T00:00:00.000Z"
      }
    }
    ```

    **Create .deco/blocks/ definitions:**
    Each block definition follows the BlockDefinition schema from Phase 2 (see 02-01-SUMMARY). These are what the CMS scanner would generate, pre-populated for the template.

    **sections--Hero.json:**
    ```json
    {
      "id": "sections--Hero",
      "type": "section",
      "title": "Hero",
      "description": "Full-width hero section with headline, subtitle, and call-to-action",
      "category": "sections",
      "filePath": "app/components/sections/Hero.tsx",
      "schema": {
        "type": "object",
        "properties": {
          "title": { "type": "string", "description": "Main headline text" },
          "subtitle": { "type": "string", "description": "Supporting description" },
          "ctaText": { "type": "string", "description": "Call-to-action button text" },
          "ctaUrl": { "type": "string", "description": "CTA button link URL" },
          "backgroundImage": { "type": "string", "description": "Optional background image URL" }
        },
        "required": ["title", "subtitle", "ctaText", "ctaUrl"]
      },
      "defaults": {
        "title": "Welcome",
        "subtitle": "Your site, your way",
        "ctaText": "Learn More",
        "ctaUrl": "#"
      },
      "metadata": {
        "customized": false,
        "lastScanned": "2026-01-01T00:00:00.000Z"
      }
    }
    ```

    Create similar block definitions for **sections--Features.json** and **sections--Footer.json**, with full JSON Schema matching their TypeScript prop interfaces. Include nested object schemas for `Feature[]` and `FooterLink[]` arrays.

    **Create .deco/loaders/loaders--products.json:**
    ```json
    {
      "id": "loaders--products",
      "type": "loader",
      "title": "Products",
      "description": "Fetches product data from an API",
      "category": "loaders",
      "filePath": "app/loaders/products.ts",
      "inputSchema": {
        "type": "object",
        "properties": {
          "limit": { "type": "number", "description": "Maximum number of products to return" },
          "category": { "type": "string", "description": "Category filter" }
        }
      },
      "outputSchema": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "id": { "type": "string" },
            "name": { "type": "string" },
            "price": { "type": "number" },
            "image": { "type": "string" }
          },
          "required": ["id", "name", "price", "image"]
        }
      },
      "defaults": { "limit": 10 },
      "metadata": {
        "customized": false,
        "lastScanned": "2026-01-01T00:00:00.000Z"
      }
    }
    ```

    **Create README.md:**
    Brief README for the template:
    - Project name and one-line description
    - Quick start: `npm install && npm run dev`
    - Directory structure overview (app/components/sections, app/loaders, .deco/)
    - How to add a new section (create component with typed props, run scanner)
    - How to add a new page (via CMS or manually in .deco/pages/)
    - How to build for production: `npm run build` (mentions prerender)
    - Link to deco.cx docs

    Keep it concise -- under 100 lines. This is a starter template README, not comprehensive docs.
  </action>
  <verify>All .deco/ JSON files are valid JSON. Page blocks reference existing block definitions by ID. Block schemas match the TypeScript prop interfaces of their corresponding sections. Loader definition has both inputSchema and outputSchema. README exists with quick start instructions.</verify>
  <done>Complete .deco/ scaffolding with pre-configured home page (3 sections), 3 block definitions with JSON Schema, 1 loader definition. README with quick start guide. Template ready for `deco create` scaffolding.</done>
</task>

</tasks>

<verification>
1. packages/starter-template/package.json has React 19, Vite, Tailwind 4, React Router 7 dependencies
2. react-router.config.ts prerender function reads .deco/pages/ for dynamic routes
3. Three example sections (Hero, Features, Footer) have exported typed prop interfaces
4. Example loader (products) has typed input and output
5. .deco/pages/page_home.json references all 3 block types with realistic prop values
6. .deco/blocks/ contains JSON Schema definitions matching TypeScript interfaces
7. .deco/loaders/ contains loader definition with input/output schemas
8. Routes render sections from page config using a section registry pattern
9. Template can be used as a starting point for `deco create`
</verification>

<success_criteria>
- Starter template is a complete, self-contained package with working build toolchain
- Example sections have rich TypeScript props (strings, arrays of objects, optional fields) that the CMS scanner can discover
- .deco/ scaffolding provides a working out-of-the-box CMS experience with pages, blocks, and loaders
- React Router 7 prerender discovers CMS pages at build time
- Template follows React 19 + Vite + Tailwind CSS 4 stack per STACK.md decisions
</success_criteria>

<output>
After completion, create `.planning/phases/05-publishing/05-03-SUMMARY.md`
</output>
