# Plan: Phase 5 - UX Refactor

## Objective

Separate Sites tab (site management) from Tasks tab (task execution with live preview).

## Context

Currently the Sites tab has a TaskPanel embedded, but the correct UX is:
- **Sites** = Site management only (pages, dev server, page actions)
- **Tasks** = Task execution with live preview when editing sites

## Tasks

### Task 1: Remove TaskPanel from Sites

**Files:** `packages/mesh-plugin-site-builder/components/site-list.tsx`

- Remove `import { TaskPanel } from "./task-panel"`
- Remove `<TaskPanel />` from the JSX
- Keep task-panel.tsx for now (may repurpose later)

### Task 2: Add Page Actions to Sites

**Files:** `packages/mesh-plugin-site-builder/components/site-list.tsx`

Add action buttons to each page row:
- **Eye** (existing) - Preview the page
- **Plus** "Create Page" button in header → Navigate to Tasks with skill selected
- **Copy** "Use as Template" on hover → Navigate to Tasks with page as reference
- **Edit** "Edit" on hover → Opens chat to discuss changes

### Task 3: Create Navigation Helper

**Files:** `packages/mesh-plugin-site-builder/lib/navigation.ts` (NEW)

Create functions to navigate to Tasks with context:
- `navigateToTasksWithSkill(skillId: string, connectionId: string)`
- `navigateToTasksWithTemplate(pagePath: string, connectionId: string)`
- `navigateToTasksForEdit(pagePath: string, connectionId: string)`

Use URL query params to pass context:
- `/tasks/:connectionId?skill=landing-page`
- `/tasks/:connectionId?template=/about&skill=landing-page`
- `/tasks/:connectionId?edit=/about`

### Task 4: Handle Context in Task Runner

**Files:** `packages/mesh-plugin-task-runner/components/task-board.tsx`

- Parse URL query params (skill, template, edit)
- Pre-select skill if `?skill=` present
- Pre-fill task title if `?template=` or `?edit=` present
- Auto-open "Add Task" form when context params present

### Task 5: Add Site Preview to Task Runner (Future)

This is more complex and can be a separate plan. For now, focus on the navigation flow.

## Verification

- [ ] Sites tab shows no task UI
- [ ] "Create Page" button navigates to Tasks with skill selected
- [ ] "Use as Template" navigates to Tasks with page context
- [ ] "Edit" button works (opens chat or creates task)
- [ ] Task Runner receives and uses the context params

## Dependencies

- Existing router setup in both plugins
- Skills available in task-runner

## Estimated Complexity

Medium - mostly UI changes and URL param handling
